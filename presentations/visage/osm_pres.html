<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>OpenStreetMap</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/leaflet/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet/leaflet.js"></script>
    <link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
    <script src="libs/Proj4Leaflet/proj4-compressed.js"></script>
    <script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding/leaflet.js"></script>
    <script src="libs/leaflet-providers/leaflet-providers_1.9.0.js"></script>
    <script src="libs/leaflet-providers-plugin/leaflet-providers-plugin.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# OpenStreetMap
## plus qu’une carte,<br>une source de données modifiables
### Cours Visage - SP2020
### xx.04.2020

---


&lt;style type="text/css"&gt;
.my-one-page-font {
  font-size: 160%;
}
.pull-left-plan{
  float: left;
  width: 53%;
}
.pull-right-plan{
  float: right;
  width: 41%;
}
.remark-slide-number {
  font-size: 8pt;
}
&lt;/style&gt;




# Plan

.pull-left-plan[
### [Introduction à OpenStreetMap (OSM)](#Intro)
### [Structure des données OSM](#Structure)
### [Récupération de données OSM](#Retrieve)
### [Ajout de données à OSM](#Contribute)
]

.pull-right-plan[
&lt;br&gt;
.middle[![](osm_pres_files/figure-html/OSM_logo.svg)]
]

---
name: Intro
class: my-one-page-font


# Bref historique

2004: création à Londres 

2006: première mise à disposition d'images satellites

2010: premières utilisations humanitaires à la suite du séisme à Haïti

2015: apparition de la possibilité de calculer des itinéraires

2018: 5'000'000 d'utilisateurs inscrits

2020: Lancement d'une nouvelle version de l'éditeur par défaut

---
class: my-one-page-font
# Pourquoi OpenStreetMap ?

Données de la planète entière disponibles au même endroit

Accès gratuit et, surtout, __libre__

--
- Pas d'intérêt commercial au traquage/traçage

--

- Facilité d'obtention et d'utilisation des données

--

Adaptation rapide à la réalité du terrain

---
class: my-one-page-font

Les données sont (en partie) visibles sur 
[www.osm.org](https://www.osm.org)

<div id="htmlwidget-c7a489469c09baf1ae3b" style="width:100%;height:80%;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-c7a489469c09baf1ae3b">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false,"maxZoom":19,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":false,"updateWhenIdle":true,"position":"bottomleft"}]}],"setView":[[46.52604,6.57993],16,[]]},"evals":[],"jsHooks":[]}</script>

---
class: my-one-page-font

# Autres services et apps basés sur OSM

[CyclOSM](https://www.cyclosm.org/#map=16/46.2323/7.3587/cyclosm) - Carte orientée vélo avec les principales particularités et infrastructures

[OpenCycleMap](http://opencyclemap.org/) - Carte orientée vélo avec les principales routes et les pubs mis en évidence

[Wheelmap](https://wheelmap.org) - Carte qui renseigne l'accessibilité en chaise roulante de bâtiments et points d'intérêt

[MapsME](https://maps.me/en/download/) - Application mobile avec cartes, points d'intérêt et itinéraires hors ligne

[OSMAnd](https://osmand.net/) - Application mobile avec cartes, points d'intérêt et itinéraires hors ligne, fonds personnalisables
---
name: Structure
class: my-one-page-font

# Structure des données

Les divers éléments géométriques utilisables

- _Nodes_
- _Ways_
- _Closed ways_
- _Areas_
- _Relations_

--

A chacun de ces éléments peuvent être associés des `tags` qui permettent de les décrire

--

Les `tags` ont la forme `key=value` et sont décrits en détails dans le [Wiki](https://wiki.openstreetmap.org/) d'OSM

---
class:my-one-page-font
## Quelques exemples pratiques d'éléments et tags

### Arrêt de bus Mouline

Elément `\(\rightarrow\)` Node

Tags
- `public_transport=platform`
- `bus=yes`
- `name=Chavannes-près-Renens, Mouline`
--

- `bench=yes`
- `shelter=yes`
- `passenger_information_display=no`
- `network=Transports lausannois`

---
class:my-one-page-font
## Quelques exemples pratiques

### Station PubliBike Mouline

Elément `\(\rightarrow\)` Node

Tags
- `amenity=bicycle_rental`
- `name=Mouline`
- `fee=yes`
--

- `website=https://publibike.ch`
- `network=PubliBike`


---
class:my-one-page-font
## Quelques exemples pratiques

### Zone de rencontre à sens unique en vieille ville

Elément `\(\rightarrow\)` Way

Tags
- `highway=living_street`
- `oneway=yes`
- `name=Chemin de Mercator`
--

- `maxspeed=20`
- `oneway:bicycle=no`
- `surface=sett`

---
class:my-one-page-font
## Quelques exemples pratiques

### Un bout de la Venoge

Elément `\(\rightarrow\)` Way

Tags
- `waterway=river`
- `name=La Venoge`

---
class:my-one-page-font
## Quelques exemples pratiques

### La Venoge

Elément `\(\rightarrow\)` __Relation__

Tags
- `waterway=river`
- `name=La Venoge`
--

- __`type=waterway`__
- `wikidata=Q689260`


--
Membres
--

- `Way La Venoge(21456774) as main_stream`
- `Way La Venoge(43645745) as main_stream`
- `Way La Venoge(37876544) as side_stream`

---
class:my-one-page-font
## Quelques exemples pratiques

### Terrains de sport

Elément `\(\rightarrow\)` Area

Tags (hockey sur gazon, terrain synthétique)
- `leisure=pitch`
- `sport=field_hockey`
- `surface=artifical_pitch`

Tags (court de terre battue)
- `leisure=pitch`
- `sport=tennis`
- `surface=clay`

---
class: my-one-page-font
name: Retrieve

# Récupérer les données d'OSM
--

Une fois les données voulues identifiées (`element`, `key`, `value` et zone d'intérêt), il faut choisir la méthode:

- Overpass Turbo

- R (package `osmdata`)

- QGIS (extension QuickOSM)

---
class: my-one-page-font
## Overpass

Overpass est l'interface (_API_) qui permet d'effectuer des requêtes (_query_) afin d'extraire des données d'OSM

&lt;br&gt;

Les requêtes sont effectuées dans le langage Overpass qui est traduit en XML afin de retourner les données.

&lt;br&gt;

Pour ceux qui ne voudraient pas se lancer dans l'apprentissage du langage, il est possible d'utiliser .center[[Overpass Turbo](https://overpass-turbo.eu/)]

---
class:my-one-page-font
## Overpass Turbo
![](./osm_pres_files/figure-html/overpass01.png)
L'onglet _Wizard_ (assistant) permet d'entrer les requêtes en anglais

Par défaut, la recherche sera effectuée dans la zone visible sur la carte

---
class:my-one-page-font
## Overpass Turbo

Essayons de récupérer les polygones des bâtiments universitaires dans le coin

--

A l'aide du [wikiOSM](https://wiki.openstreetmap.org/wiki/Tag:building%3Duniversity), on sait que la _key_ à utiliser est `building` et la _value_ est `university`. Le tag est donc .big.center[__`building=university`__]

--

Il reste encore à déplacer la carte sur le secteur de l'UNIL

---
class:my-one-page-font
## Overpass Turbo
.center[
&lt;img src="./osm_pres_files/figure-html/overpass02.png" width="90%" height="400px" /&gt;

Dire à l'assistant de construire la requête pour les "bâtiments universitaires"
]

---
class: my-one-page-font
## Overpass Turbo

Modifier la requête pour ne pas prendre en compte les _nodes_ et relations et l'exécuter en appuyant sur _Run_
.pull-left[
![](osm_pres_files/figure-html/overpass03.png)
]

.pull-right[
![](osm_pres_files/figure-html/overpass04.png)
]

---
class:my-one-page-font
## Overpass Turbo


.pull-left[
&lt;img src="osm_pres_files/figure-html/overpass05.png" width="936" /&gt;
]

.pull-right[
Les éléments sélectionnés apparaissent sur la carte

Ceux qui sont trop petits pour être bien visibles apparaissent sous la forme de ronds

En bas à droite de la carte, un résumé des résultats s'affiche
]

--

Pour exporter les résultats, cliquer sur l'onglet _Export_ &gt; _download as GeoJSON_. Vous avez maintenant une couche prête à être ouverte dans QGIS

---
## R (package `osmdata`)
--


```r
# Charger le package
library(osmdata)
# Construire et exécuter la requête
bat_uni_Lausanne &lt;- opq("Lausanne") %&gt;%
  add_osm_feature(key="building", value="university") %&gt;%
  osmdata_sf()
# Garder uniquement les polygones
bat_uni_Lausanne &lt;- bat_uni_Lausanne$osm_polygons
```
--

<div id="htmlwidget-74ff0a6964f74ec9f5e2" style="width:792px;height:288px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-74ff0a6964f74ec9f5e2">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.DarkMatter",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false,"maxZoom":19}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":false,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addPolygons","args":[[[[{"lng":[6.5834859,6.5836918,6.583694,6.584006,6.5839984,6.584006,6.5836749,6.5836663,6.5836659,6.5836664,6.5846194,6.5846194,6.584751,6.584751,6.5845961,6.5845947,6.5846025,6.5847043,6.5847065,6.5844709,6.5844687,6.5843966,6.5835878,6.5835836,6.5834881,6.5834859],"lat":[46.5222745,46.522273,46.5222233,46.5222248,46.5223769,46.5224658,46.5224614,46.5225507,46.5225659,46.5228017,46.5228075,46.5227725,46.5227272,46.5226177,46.5225534,46.5225142,46.5224658,46.5224205,46.5220291,46.5219254,46.521867,46.5218173,46.5218115,46.5219415,46.5219429,46.5222745]}]],[[{"lng":[6.5844454,6.5848211,6.5849017,6.5849951,6.5851137,6.5852477,6.5851607,6.5852583,6.5851947,6.5850907,6.5850864,6.5850503,6.5848657,6.5848657,6.5847404,6.5846194,6.5846131,6.5845791,6.5843966,6.5843923,6.5842841,6.5841461,6.5841418,6.5841015,6.5839296,6.5839211,6.5838744,6.5837789,6.5836897,6.5835619,6.5834286,6.5835263,6.5834329,6.5835036,6.5835025,6.5834416,6.5834541,6.5834723,6.5835051,6.5837895,6.5838234,6.5838764,6.5839487,6.5841694,6.5841737,6.584301,6.584301,6.5843555,6.5843966,6.5843966,6.5844454],"lat":[46.5230573,46.5230617,46.5231172,46.5230661,46.5231531,46.5232515,46.5233085,46.5233698,46.5234093,46.5234064,46.5235217,46.5235495,46.5235495,46.5236357,46.5237247,46.5237189,46.5238343,46.5238693,46.5238693,46.523957,46.5240358,46.5240417,46.52416,46.5241906,46.5241877,46.5242666,46.5243016,46.5242418,46.5243016,46.5242174,46.524122,46.5240592,46.5240008,46.523956,46.5239366,46.5239335,46.523735,46.5237241,46.5237028,46.5236999,46.5237306,46.5236972,46.5236459,46.523643,46.5235626,46.5235597,46.5234122,46.5233705,46.5233392,46.5230894,46.5230573]}]],[[{"lng":[6.5847872,6.5849033,6.5844974,6.5843813,6.5847872],"lat":[46.5195011,46.5193039,46.5191907,46.5193879,46.5195011]}]],[[{"lng":[6.5850508,6.5853064,6.5855696,6.5855793,6.5850605,6.5850508],"lat":[46.5224237,46.522426,46.5224285,46.5219337,46.5219289,46.5224237]}]],[[{"lng":[6.6155685,6.615487,6.6159725,6.616444,6.6164799,6.6167325,6.6167999,6.6165833,6.616564,6.6155685],"lat":[46.5243442,46.5241791,46.5240716,46.5239656,46.5240407,46.5239855,46.5241286,46.5241745,46.524134,46.5243442]}]],[[{"lng":[6.6153611,6.6152101,6.6158159,6.6158507,6.6161269,6.6161586,6.6164691,6.616582,6.6159791,6.615957,6.6159093,6.6153611],"lat":[46.5240406,46.5237191,46.5235799,46.5236466,46.5235807,46.5236471,46.5235834,46.5238205,46.5239518,46.5239056,46.5239164,46.5240406]}]],[[{"lng":[6.6337785,6.6338358,6.6338172,6.6340485,6.6340903,6.6343831,6.6343966,6.6344711,6.6344176,6.6340203,6.6339754,6.6339015,6.6339273,6.6337643,6.6337437,6.6337246,6.6337035,6.6335384,6.6335253,6.6334746,6.6334627,6.633452,6.6333969,6.6333828,6.6335454,6.6335017,6.6335202,6.6333554,6.633333,6.6332783,6.6335089,6.633582,6.6337785],"lat":[46.5229053,46.5229951,46.5230007,46.5233634,46.523429,46.5238882,46.5238841,46.5240009,46.5240171,46.524137,46.5241505,46.5240346,46.5240269,46.5237713,46.5237389,46.5237446,46.5237115,46.5237614,46.5237408,46.5236613,46.5236425,46.5236257,46.5235394,46.5235172,46.5234681,46.5233995,46.5233939,46.5231354,46.5231422,46.5230563,46.5229867,46.5229646,46.5229053]}]],[[{"lng":[6.6583566,6.6585227,6.6593401,6.6590909,6.6587113,6.6583566],"lat":[46.541612,46.5414991,46.541644,46.5417786,46.5416726,46.541612]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"white","weight":1,"opacity":0.9,"fill":true,"fillColor":"white","fillOpacity":0.9,"smoothFactor":1,"noClip":false},null,null,["Internef","Anthropole","Vestiaires","Extranef","École des Métiers","École des Métiers","Palais de Rumine","Institut universitaire de médecine sociale et préventive"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[46.5191907,46.5417786],"lng":[6.5834286,6.6593401]}},"evals":[],"jsHooks":[]}</script>

---
## R (package `osmdata`)
--


```r
# Charger le package
library(osmdata)
# Construire et exécuter la requête
bat_uni_bbox &lt;- opq(c(6.5716, 46.5168, 6.5864, 46.5288)) %&gt;%
  add_osm_feature(key="building", value="university") %&gt;%
  osmdata_sf()
# Garder uniquement les polygones
bat_uni_bbox &lt;- bat_uni_bbox$osm_polygons
```
--

<div id="htmlwidget-0691fbb5ebfb8eb1502a" style="width:792px;height:288px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-0691fbb5ebfb8eb1502a">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.DarkMatter",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false,"maxZoom":19}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":false,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addPolygons","args":[[[[{"lng":[6.5804013,6.5804005,6.5803991,6.580386,6.580225,6.5800684,6.5799129,6.5797632,6.5795784,6.5794249,6.5793111,6.5792939,6.5792065,6.5787997,6.5788039,6.5788462,6.5787089,6.5787774,6.5788486,6.5789301,6.5790234,6.5789813,6.5791149,6.579322,6.5794795,6.5796402,6.5798142,6.5799893,6.5801946,6.5803887,6.5804013],"lat":[46.5231779,46.5228133,46.5227137,46.5227131,46.5227056,46.5226842,46.5226488,46.5225996,46.5225136,46.5224128,46.5223111,46.5222896,46.5221799,46.5222991,46.5223057,46.522373,46.5224252,46.5225088,46.5225823,46.5226547,46.5227259,46.5227583,46.5228478,46.5229573,46.5230222,46.5230749,46.5231185,46.5231498,46.5231716,46.5231775,46.5231779]}]],[[{"lng":[6.5713387,6.5713396,6.5712479,6.5712521,6.5711638,6.5709747,6.5709753,6.570977,6.5709774,6.5711669,6.5712566,6.5712616,6.5713514,6.5713522,6.5715439,6.5715431,6.5716355,6.5716338,6.5715368,6.5715381,6.5717702,6.5717675,6.5717659,6.5717678,6.5715569,6.5715538,6.5716241,6.5716197,6.5715235,6.5715227,6.5713387],"lat":[46.5210346,46.5209684,46.5209679,46.5206506,46.5206501,46.5206489,46.5206081,46.520478,46.5204424,46.5204436,46.5204442,46.5200627,46.5200632,46.5200019,46.5200031,46.5200638,46.5200644,46.5201974,46.5201968,46.5203734,46.5203762,46.5205441,46.5205589,46.5206544,46.5206521,46.5208381,46.5208369,46.520975,46.5209744,46.5210358,46.5210346]}]],[[{"lng":[6.5721072,6.5726503,6.5730084,6.573009,6.5727899,6.5727914,6.5730023,6.5730088,6.5730093,6.5724592,6.5721143,6.57212,6.5721199,6.572365,6.5723629,6.5721096,6.5721072],"lat":[46.5214868,46.5214901,46.5214923,46.5213014,46.5212985,46.521141,46.5211435,46.5210042,46.5209569,46.520955,46.5209464,46.5211228,46.5211357,46.5211373,46.5212982,46.5212966,46.5214868]}]],[[{"lng":[6.5737964,6.5745599,6.5745815,6.5745822,6.5745823,6.5747122,6.5747126,6.5745711,6.5745714,6.5737998,6.5737995,6.5737982,6.5737964],"lat":[46.5216143,46.5216169,46.5216169,46.5213174,46.5213028,46.5213031,46.5212135,46.5212132,46.5211425,46.5211408,46.5211942,46.5213653,46.5216143]}]],[[{"lng":[6.5764333,6.5768657,6.5770276,6.5774736,6.5774812,6.5773659,6.5773031,6.5773042,6.5762559,6.576253,6.5763767,6.5764371,6.5764359,6.5767611,6.5767602,6.5767594,6.5764362,6.5764333],"lat":[46.5212002,46.5212032,46.5212043,46.5212074,46.5206824,46.5206816,46.5206328,46.5205541,46.520547,46.5207482,46.520749,46.5207949,46.5208761,46.5208783,46.5209442,46.5209981,46.5209959,46.5212002]}]],[[{"lng":[6.5737974,6.5742344,6.5742347,6.5742349,6.5744611,6.5744618,6.5735787,6.5735784,6.5735779,6.5737977,6.5737976,6.5737974],"lat":[46.5198965,46.5198969,46.5197771,46.5196684,46.5196686,46.5193284,46.5193275,46.5194759,46.5197165,46.5197167,46.5197651,46.5198965]}]],[[{"lng":[6.5721352,6.5724632,6.5724615,6.5725159,6.5725156,6.5726468,6.5727183,6.5727108,6.5725322,6.5725323,6.5724572,6.5724559,6.5724596,6.5724698,6.5722885,6.5722858,6.5721712,6.5721539,6.5721537,6.5721282,6.5721256,6.5720974,6.57208,6.5721256,6.5721269,6.5721577,6.5721474,6.5721403,6.572144,6.5721162,6.5721155,6.572092,6.5720746,6.5720706,6.5721135,6.5721128,6.5721457,6.5721457,6.572137,6.5721108,6.5721081,6.5720833,6.5720639,6.5721074,6.5721088,6.572137,6.5721352],"lat":[46.520285,46.5202873,46.5199393,46.5199392,46.5199576,46.5199824,46.5198356,46.5197324,46.5197304,46.519746,46.5197455,46.5197051,46.5194756,46.5189591,46.5189583,46.5189264,46.518913,46.5189446,46.5191165,46.5191184,46.5190907,46.5190907,46.5191756,46.5191793,46.5191368,46.5191359,46.5194403,46.5194579,46.5197104,46.5197108,46.5196873,46.5196873,46.5197256,46.5197754,46.5197768,46.5197334,46.5197339,46.5198068,46.5200726,46.5200735,46.5200532,46.5200532,46.5201381,46.5201395,46.5200952,46.5200947,46.520285]}]],[[{"lng":[6.5810418,6.5808546,6.5809878,6.5810928,6.5811565,6.5811752,6.5811991,6.5814982,6.5814865,6.5814702,6.5814183,6.5813392,6.5812381,6.5811983,6.5811242,6.5810418],"lat":[46.5227702,46.5226084,46.5225243,46.5224219,46.5223217,46.5222414,46.5221505,46.5221996,46.5222547,46.5223317,46.5224427,46.5225502,46.5226462,46.5226767,46.5227254,46.5227702]}]],[[{"lng":[6.5821386,6.5823299,6.5822152,6.5820239,6.5821386],"lat":[46.5234529,46.5233002,46.5232322,46.5233849,46.5234529]}]],[[{"lng":[6.5822184,6.5823559,6.5825284,6.5823908,6.5822184],"lat":[46.5240129,46.5238638,46.5239391,46.5240882,46.5240129]}]],[[{"lng":[6.5825269,6.5830241,6.5830296,6.5828139,6.5828147,6.5827346,6.5827338,6.5825328,6.5825318,6.5823002,6.5822989,6.5825301,6.5825269],"lat":[46.5219636,46.5219675,46.5216308,46.5216291,46.5215784,46.5215778,46.521628,46.5216265,46.5216883,46.5216865,46.5217664,46.5217682,46.5219636]}]],[[{"lng":[6.5834859,6.5836918,6.583694,6.584006,6.5839984,6.584006,6.5836749,6.5836663,6.5836659,6.5836664,6.5846194,6.5846194,6.584751,6.584751,6.5845961,6.5845947,6.5846025,6.5847043,6.5847065,6.5844709,6.5844687,6.5843966,6.5835878,6.5835836,6.5834881,6.5834859],"lat":[46.5222745,46.522273,46.5222233,46.5222248,46.5223769,46.5224658,46.5224614,46.5225507,46.5225659,46.5228017,46.5228075,46.5227725,46.5227272,46.5226177,46.5225534,46.5225142,46.5224658,46.5224205,46.5220291,46.5219254,46.521867,46.5218173,46.5218115,46.5219415,46.5219429,46.5222745]}]],[[{"lng":[6.5844454,6.5848211,6.5849017,6.5849951,6.5851137,6.5852477,6.5851607,6.5852583,6.5851947,6.5850907,6.5850864,6.5850503,6.5848657,6.5848657,6.5847404,6.5846194,6.5846131,6.5845791,6.5843966,6.5843923,6.5842841,6.5841461,6.5841418,6.5841015,6.5839296,6.5839211,6.5838744,6.5837789,6.5836897,6.5835619,6.5834286,6.5835263,6.5834329,6.5835036,6.5835025,6.5834416,6.5834541,6.5834723,6.5835051,6.5837895,6.5838234,6.5838764,6.5839487,6.5841694,6.5841737,6.584301,6.584301,6.5843555,6.5843966,6.5843966,6.5844454],"lat":[46.5230573,46.5230617,46.5231172,46.5230661,46.5231531,46.5232515,46.5233085,46.5233698,46.5234093,46.5234064,46.5235217,46.5235495,46.5235495,46.5236357,46.5237247,46.5237189,46.5238343,46.5238693,46.5238693,46.523957,46.5240358,46.5240417,46.52416,46.5241906,46.5241877,46.5242666,46.5243016,46.5242418,46.5243016,46.5242174,46.524122,46.5240592,46.5240008,46.523956,46.5239366,46.5239335,46.523735,46.5237241,46.5237028,46.5236999,46.5237306,46.5236972,46.5236459,46.523643,46.5235626,46.5235597,46.5234122,46.5233705,46.5233392,46.5230894,46.5230573]}]],[[{"lng":[6.5847872,6.5849033,6.5844974,6.5843813,6.5847872],"lat":[46.5195011,46.5193039,46.5191907,46.5193879,46.5195011]}]],[[{"lng":[6.5771276,6.5772014,6.5770591,6.5769852,6.5771276],"lat":[46.5191562,46.5190708,46.5190125,46.5190979,46.5191562]}]],[[{"lng":[6.5823842,6.5823843,6.5825083,6.5825083,6.58255,6.58255,6.5823842],"lat":[46.5222225,46.5223079,46.5223078,46.5222765,46.5222765,46.5222225,46.5222225]}]],[[{"lng":[6.5715407,6.5715721,6.5716246,6.5716475,6.5716998,6.5718044,6.5718086,6.5718442,6.5718497,6.5718526,6.5718358,6.5718121,6.5717919,6.5717354,6.5717333,6.571681,6.5716831,6.5715407],"lat":[46.5184177,46.5181801,46.5181841,46.5181859,46.518111,46.5181168,46.5181787,46.518183,46.5182294,46.5182536,46.5183486,46.5183906,46.5184264,46.5184221,46.5184667,46.5184667,46.5184221,46.5184177]}]],[[{"lng":[6.5800249,6.5803657,6.5787997,6.5787481,6.5784977,6.578459,6.5800249],"lat":[46.5259915,46.5263377,46.5270673,46.5270149,46.5267604,46.5267211,46.5259915]}]],[[{"lng":[6.5807443,6.5807023,6.5808376,6.5807412,6.5809841,6.581065,6.5811808,6.5812382,6.5807443],"lat":[46.5258849,46.5258352,46.5257807,46.5256668,46.525569,46.5256647,46.5256181,46.5256859,46.5258849]}]],[[{"lng":[6.5778204,6.5777534,6.5779836,6.5779166,6.5779376,6.5779244,6.5779662,6.5780155,6.5780144,6.5780733,6.5781269,6.5781334,6.5781944,6.578233,6.5782598,6.5783186,6.578381,6.5784781,6.5786318,6.5784526,6.5785983,6.5784219,6.5785714,6.5784141,6.5779672,6.5778978,6.5778706,6.5778957,6.5778455,6.5778204],"lat":[46.5256631,46.5256127,46.5254687,46.5254226,46.5254082,46.5253997,46.5253768,46.5253672,46.5253451,46.5253444,46.525351,46.5253326,46.5253473,46.5253658,46.5253864,46.5253504,46.5253961,46.5253434,46.5254559,46.5255754,46.5256821,46.5257898,46.5258992,46.5260009,46.5256738,46.5257192,46.5257005,46.5256818,46.5256501,46.5256631]}]],[[{"lng":[6.5779363,6.5777019,6.5773654,6.5778342,6.5779263,6.5779648,6.5782377,6.5782076,6.5782645,6.5780586,6.5780478,6.5779706,6.5779363],"lat":[46.5262215,46.5260464,46.5262584,46.5266074,46.5265625,46.526589,46.5264542,46.5264266,46.5263989,46.5262526,46.5262578,46.5261988,46.5262215]}]],[[{"lng":[6.5747073,6.5750752,6.5750752,6.5753639,6.5753603,6.5753265,6.5752801,6.5752824,6.5750158,6.5750065,6.5750919,6.5750902,6.5752094,6.5752098,6.5752582,6.5752677,6.5756186,6.5756121,6.5756993,6.5756986,6.5758393,6.5758389,6.5758914,6.5758993,6.5756253,6.5756248,6.5755702,6.5755719,6.575858,6.5758591,6.5762455,6.576252,6.5755965,6.5755981,6.5758092,6.5758082,6.5759423,6.5759442,6.5755974,6.575598,6.5755445,6.5753855,6.5753845,6.5749809,6.5749804,6.5748648,6.5747126,6.5747122,6.5747073],"lat":[46.5216907,46.5216943,46.5217575,46.5217606,46.5220073,46.5220073,46.5220075,46.5218719,46.5218697,46.52248,46.5224807,46.5225286,46.522529,46.5224992,46.5224994,46.5221742,46.522177,46.5225796,46.5225801,46.5226236,46.5226234,46.522586,46.5225864,46.5219694,46.5219671,46.5220119,46.5220115,46.5218903,46.5218924,46.5218204,46.5218232,46.5213978,46.521395,46.5213165,46.5213179,46.521369,46.52137,46.5212026,46.5211999,46.5211719,46.5211711,46.52117,46.5211902,46.5211877,46.5212139,46.5212139,46.5212135,46.5213031,46.5216907]}]],[[{"lng":[6.5834486,6.5835774,6.5835824,6.5836659,6.5836663,6.5835829,6.5835845,6.5834566,6.5834486],"lat":[46.5228717,46.5228726,46.5225648,46.5225659,46.5225507,46.5225496,46.5224537,46.5224528,46.5228717]}]],[[{"lng":[6.5835496,6.5835463,6.5834429,6.5834546,6.5835632,6.5835496],"lat":[46.5187448,46.518767,46.5187655,46.5184192,46.5184218,46.5187448]}]],[[{"lng":[6.5770101,6.5773489,6.5773498,6.5770109,6.5770101],"lat":[46.5229066,46.5229079,46.5228055,46.5228042,46.5229066]}]],[[{"lng":[6.5850508,6.5853064,6.5855696,6.5855793,6.5850605,6.5850508],"lat":[46.5224237,46.522426,46.5224285,46.5219337,46.5219289,46.5224237]}]],[[{"lng":[6.5806861,6.5804435,6.5806487,6.5808669,6.5806861],"lat":[46.5262288,46.5259588,46.5258692,46.5261381,46.5262288]}]],[[{"lng":[6.5824496,6.5824521,6.5829958,6.5829933,6.5824496],"lat":[46.5213982,46.5210275,46.5210293,46.5213999,46.5213982]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":0,"opacity":0.5,"fill":true,"fillColor":"white","fillOpacity":0.9,"smoothFactor":1,"noClip":false},null,null,["Unithèque","BS","Cubotron","Amphimax","Biophore","Genopode","Batochime","Unicentre","Château de Dorigny","Ferme de Dorigny","Institut Suisse de Droit Comparé","Internef","Anthropole","Vestiaires","Villa des Sports","Maison Rose","ODY","Geopolis","Ferme de la Mouline","Archives cantonales vaudoises","IDHEAP","Amphipole","Bibliothèque Edouard Fleuret","Centre Nautique","Bergerie","Extranef","Annexe de la Mouline","Synathlon"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[46.518111,46.5270673],"lng":[6.5709747,6.5855793]}},"evals":[],"jsHooks":[]}</script>

---
class: my-one-page-font
## R (package `osmdata`)

Pour exporter les résultats, il faut enregistrer la variable dans un format utilisable dans un SIG


```r
# Charger le package
library(sf)

# Format Geopackage
st_write(bat_uni_bbox, "bats_unil.gpkg")

# Format Shapefile
st_write(bat_uni_bbox, "bats_unil.shp")
```

On obtient ainsi la même couche vectorielle qu'avec Overpass Turbo

---
class: my-one-page-font
# QGIS (extension QuickOSM)
--

L'extension est aussi une interface vers Overpass

Il faut l'installer en allant dans le menu _Extensions_ &gt; _Gérer les extensions_ &gt; _Toutes_ &gt; __QuickOSM__ &gt; _Installer_

L'extension est ensuite disponible dans le menu _Vecteur_

.center[![](osm_pres_files/figure-html/QuickOSM_logo.svg)]

---
class: my-one-page-font
# QGIS (extension QuickOSM)

On utilise une recherche autour de la commune de Chavannes-près-Renens 
.center[
&lt;img src="osm_pres_files/figure-html/qgis01.png" width="80%" height="120px" /&gt;


&lt;img src="osm_pres_files/figure-html/qgis02.png" width="60%" height="270px" /&gt;
]

---
class: my-one-page-font
# QGIS (extension QuickOSM)

Les éléments téléchargés s'affichent sur le plan de travail
![](osm_pres_files/figure-html/qgis03.png)

Il ne reste plus qu'à enregistrer la couche


---
class: my-one-page-font
# QGIS (extension QuickOSM)

Sélectionner la couche dans le menu d'affichage, aller dans le menu _Couche_ &gt; _Sauvegarder sous_

.center[
&lt;img src="osm_pres_files/figure-html/qgis04.png" width="90%" height="300px" /&gt;
]

Choisir le format, indiquez un emplacement (__à l'aide des *...*__) et choisir un [CRS](https://github.com/christiankaiser/carto-sig/blob/master/presentations/03-pres-crs-proj.pdf) avant de mettre _OK_

---
class:my-one-page-font
name: Contribute

# Contribuer à OSM
--

L'exhaustivité et la qualité des données dépendent des contributions des utilisateurs

S'il manque des éléments, qu'ils ne sont plus à jour ou faux, il est facile de le corriger afin que cela puisse profiter à tous
--


Les 4 bases pour [contribuer](https://wiki.openstreetmap.org/wiki/FR:Contribuer_aux_donn%C3%A9es_cartographiques) sont:
- Authenticité (ne rien inventer)
- Légalité (ne pas utiliser de sources sous _copyright_)
- Vérifiabilité (serait confirmé sur place)
- Pertinence (utilisation des _tags_ appropriés)

---
class:my-one-page-font

# Contribuer à OSM - iD editor

Il suffit d'aller sur l'onglet _Edit_ / _Modifier_ du site principal et de se connecter/créer un compte

[![](osm_pres_files/figure-html/edit01.png)](https://osm.org/edit)

--

Vous accédez ensuite au mode édition, sur lequel il est possible de voir l'ensemble des éléments ainsi qu'un fond de carte avec des images satellites

---
class:my-one-page-font

# Contribuer à OSM - iD editor

En travaillant avec des fonds satellites, il faut [garder en tête leurs limites](https://wiki.openstreetmap.org/wiki/FR:Using_Imagery) (décalage et ancienneté)

.center[
&lt;img src="osm_pres_files/figure-html/edit03.png" width="85%" height="400px" /&gt;
]

---
En cliquant sur un élément, on peut voir les tags associés, sous la forme de cases à remplir (_g._) ou en liste d'attributs
--

.pull-left[
&lt;img src="osm_pres_files/figure-html/edit04.png" width="90%" height="500px" /&gt;
]

--

.pull-right[
![](osm_pres_files/figure-html/edit05.png)
]

---
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
